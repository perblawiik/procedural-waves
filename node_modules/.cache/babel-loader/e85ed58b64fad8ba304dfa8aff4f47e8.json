{"ast":null,"code":"import FragmentShader from './shaders/FragmentShader';\nimport VertexShader from './shaders/VertexShader';\nimport Matrix4 from './math/Matrix4';\n\nclass Shader {\n  constructor(canvas, vertexShaderFile, fragmentShaderFile) {\n    this.canvas = canvas;\n    this.gl = this.canvas.getContext(\"webgl\");\n    this.init(vertexShaderFile, fragmentShaderFile);\n  }\n\n  init(vertexShaderFile, fragmentShaderFile) {\n    // Set up the vertex and fragment shaders (glsl)\n    let vertexShader = this.createShader(this.gl.VERTEX_SHADER, vertexShaderFile);\n    let fragmentShader = this.createShader(this.gl.FRAGMENT_SHADER, fragmentShaderFile); // Attach shaders to our program\n\n    this.program = this.createProgram(vertexShader, fragmentShader); // Catches additional errors /\n\n    /****(ONLY USED IN TESTING)****/\n\n    this.gl.validateProgram(this.program);\n\n    if (!this.gl.getProgramParameter(this.program, this.gl.VALIDATE_STATUS)) {\n      console.error(\"ERROR validating program!\", this.gl.getProgramInfoLog(this.program));\n    }\n    /****(ONLY USED IN TESTING)****/\n    // Tell OpenGL state machine which program should be active\n\n\n    this.gl.useProgram(this.program); //Get attribute location from vertex shader text (glsl)\n\n    this.positionAttributeLocation = this.gl.getAttribLocation(this.program, \"vertPosition\");\n    this.normalAttributeLocation = this.gl.getAttribLocation(this.program, \"vertNormal\");\n    this.textureAttributeLocation = this.gl.getAttribLocation(this.program, \"vertTexCoord\"); // Get uniform location from shaders\n    // mat4\n\n    this.worldViewUniformLocation = this.gl.getUniformLocation(this.program, \"modelView\");\n    this.projectionMatrixUniformLocation = this.gl.getUniformLocation(this.program, \"perspective\"); // vec3\n\n    this.colorUniformLocation = this.gl.getUniformLocation(this.program, \"diffuseColor\");\n    this.timeUniformLocation = this.gl.getUniformLocation(this.program, \"time\"); // The projection matrix adds 3D perspective (depth) to the graphics\n\n    this.projectionMatrix = Matrix4.perspective(Math.PI / 5, this.canvas.width / this.canvas.height, 0.1, 10000.0); // Link the uniform with the matrix variable\n\n    this.gl.uniformMatrix4fv(this.projectionMatrixUniformLocation, this.gl.FALSE, this.projectionMatrix);\n  }\n\n  use() {\n    this.gl.useProgram(this.program);\n  }\n\n  createShader(type, source) {\n    let shader = this.gl.createShader(type);\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader); // Check for errors\n\n    if (this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n      return shader;\n    }\n\n    console.error(\"ERROR compiling shader!\", this.gl.getShaderInfoLog(shader));\n    this.gl.deleteShader(shader);\n  }\n\n  createProgram(vertexShader, fragmentShader) {\n    let program = this.gl.createProgram();\n    this.gl.attachShader(program, vertexShader);\n    this.gl.attachShader(program, fragmentShader);\n    this.gl.linkProgram(program); // Check for errors\n\n    if (this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\n      return program;\n    }\n\n    console.error(\"ERROR linking program!\", this.gl.getProgramInfoLog(program));\n    this.gl.deleteProgram(program);\n  }\n\n  setProjectionMatrix(aspectRatio) {\n    // The projection matrix adds 3D perspective (depth) to the graphics\n    this.projectionMatrix = Matrix4.perspective(Math.PI / 5, aspectRatio, 0.1, 10000.0); // Link the uniform with the matrix variable\n\n    this.gl.uniformMatrix4fv(this.projectionMatrixUniformLocation, this.gl.FALSE, this.projectionMatrix);\n  }\n\n  getUniformLocation(uniformName) {\n    return this.gl.getUniformLocation(this.program, uniformName);\n  }\n\n  setUniformVec3f(location, vector) {\n    this.gl.uniform3fv(location, [vector.x, vector.y, vector.z]);\n  }\n\n  setUniformMat4f(location, matrix) {\n    this.gl.uniformMatrix4fv(location, this.gl.FALSE, matrix);\n  }\n\n}\n\nexport default Shader;","map":{"version":3,"sources":["G:\\DOKUMENT\\Projekt\\React\\BlueBox\\client\\src\\js\\bluebox\\Shader.js"],"names":["FragmentShader","VertexShader","Matrix4","Shader","constructor","canvas","vertexShaderFile","fragmentShaderFile","gl","getContext","init","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","createProgram","validateProgram","getProgramParameter","VALIDATE_STATUS","console","error","getProgramInfoLog","useProgram","positionAttributeLocation","getAttribLocation","normalAttributeLocation","textureAttributeLocation","worldViewUniformLocation","getUniformLocation","projectionMatrixUniformLocation","colorUniformLocation","timeUniformLocation","projectionMatrix","perspective","Math","PI","width","height","uniformMatrix4fv","FALSE","use","type","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","attachShader","linkProgram","LINK_STATUS","deleteProgram","setProjectionMatrix","aspectRatio","uniformName","setUniformVec3f","location","vector","uniform3fv","x","y","z","setUniformMat4f","matrix"],"mappings":"AAAA,OAAOA,cAAP,MAA2B,0BAA3B;AACA,OAAOC,YAAP,MAAyB,wBAAzB;AACA,OAAOC,OAAP,MAAoB,gBAApB;;AAEA,MAAMC,MAAN,CAAa;AACTC,EAAAA,WAAW,CAACC,MAAD,EAASC,gBAAT,EAA2BC,kBAA3B,EAA+C;AACtD,SAAKF,MAAL,GAAcA,MAAd;AACA,SAAKG,EAAL,GAAU,KAAKH,MAAL,CAAYI,UAAZ,CAAuB,OAAvB,CAAV;AACA,SAAKC,IAAL,CAAUJ,gBAAV,EAA4BC,kBAA5B;AACH;;AAEDG,EAAAA,IAAI,CAACJ,gBAAD,EAAmBC,kBAAnB,EAAuC;AACvC;AACA,QAAII,YAAY,GAAG,KAAKC,YAAL,CAAkB,KAAKJ,EAAL,CAAQK,aAA1B,EAAyCP,gBAAzC,CAAnB;AACA,QAAIQ,cAAc,GAAG,KAAKF,YAAL,CAAkB,KAAKJ,EAAL,CAAQO,eAA1B,EAA2CR,kBAA3C,CAArB,CAHuC,CAKvC;;AACA,SAAKS,OAAL,GAAe,KAAKC,aAAL,CAAmBN,YAAnB,EAAiCG,cAAjC,CAAf,CANuC,CAQvC;;AACA;;AACA,SAAKN,EAAL,CAAQU,eAAR,CAAwB,KAAKF,OAA7B;;AACA,QAAG,CAAC,KAAKR,EAAL,CAAQW,mBAAR,CAA4B,KAAKH,OAAjC,EAA0C,KAAKR,EAAL,CAAQY,eAAlD,CAAJ,EAAwE;AACpEC,MAAAA,OAAO,CAACC,KAAR,CAAc,2BAAd,EAA2C,KAAKd,EAAL,CAAQe,iBAAR,CAA0B,KAAKP,OAA/B,CAA3C;AACH;AACD;AAEA;;;AACA,SAAKR,EAAL,CAAQgB,UAAR,CAAmB,KAAKR,OAAxB,EAjBuC,CAmBvC;;AACA,SAAKS,yBAAL,GAAiC,KAAKjB,EAAL,CAAQkB,iBAAR,CAA0B,KAAKV,OAA/B,EAAwC,cAAxC,CAAjC;AACA,SAAKW,uBAAL,GAA+B,KAAKnB,EAAL,CAAQkB,iBAAR,CAA0B,KAAKV,OAA/B,EAAwC,YAAxC,CAA/B;AACA,SAAKY,wBAAL,GAAgC,KAAKpB,EAAL,CAAQkB,iBAAR,CAA0B,KAAKV,OAA/B,EAAwC,cAAxC,CAAhC,CAtBuC,CAwBvC;AACA;;AACA,SAAKa,wBAAL,GAAgC,KAAKrB,EAAL,CAAQsB,kBAAR,CAA2B,KAAKd,OAAhC,EAAyC,WAAzC,CAAhC;AACA,SAAKe,+BAAL,GAAuC,KAAKvB,EAAL,CAAQsB,kBAAR,CAA2B,KAAKd,OAAhC,EAAyC,aAAzC,CAAvC,CA3BuC,CA6BvC;;AACA,SAAKgB,oBAAL,GAA4B,KAAKxB,EAAL,CAAQsB,kBAAR,CAA2B,KAAKd,OAAhC,EAAyC,cAAzC,CAA5B;AACA,SAAKiB,mBAAL,GAA2B,KAAKzB,EAAL,CAAQsB,kBAAR,CAA2B,KAAKd,OAAhC,EAAyC,MAAzC,CAA3B,CA/BuC,CAiCvC;;AACA,SAAKkB,gBAAL,GAAwBhC,OAAO,CAACiC,WAAR,CAAoBC,IAAI,CAACC,EAAL,GAAU,CAA9B,EAAiC,KAAKhC,MAAL,CAAYiC,KAAZ,GAAoB,KAAKjC,MAAL,CAAYkC,MAAjE,EAAyE,GAAzE,EAA8E,OAA9E,CAAxB,CAlCuC,CAmCvC;;AACA,SAAK/B,EAAL,CAAQgC,gBAAR,CAAyB,KAAKT,+BAA9B,EAA+D,KAAKvB,EAAL,CAAQiC,KAAvE,EAA8E,KAAKP,gBAAnF;AACH;;AAEDQ,EAAAA,GAAG,GAAI;AACH,SAAKlC,EAAL,CAAQgB,UAAR,CAAmB,KAAKR,OAAxB;AACH;;AAEDJ,EAAAA,YAAY,CAAC+B,IAAD,EAAOC,MAAP,EAAe;AACvB,QAAIC,MAAM,GAAG,KAAKrC,EAAL,CAAQI,YAAR,CAAqB+B,IAArB,CAAb;AACA,SAAKnC,EAAL,CAAQsC,YAAR,CAAqBD,MAArB,EAA6BD,MAA7B;AACA,SAAKpC,EAAL,CAAQuC,aAAR,CAAsBF,MAAtB,EAHuB,CAKvB;;AACA,QAAG,KAAKrC,EAAL,CAAQwC,kBAAR,CAA2BH,MAA3B,EAAmC,KAAKrC,EAAL,CAAQyC,cAA3C,CAAH,EAA+D;AAC3D,aAAOJ,MAAP;AACH;;AAEDxB,IAAAA,OAAO,CAACC,KAAR,CAAc,yBAAd,EAAyC,KAAKd,EAAL,CAAQ0C,gBAAR,CAAyBL,MAAzB,CAAzC;AACA,SAAKrC,EAAL,CAAQ2C,YAAR,CAAqBN,MAArB;AACH;;AAED5B,EAAAA,aAAa,CAACN,YAAD,EAAeG,cAAf,EAA+B;AACxC,QAAIE,OAAO,GAAG,KAAKR,EAAL,CAAQS,aAAR,EAAd;AACA,SAAKT,EAAL,CAAQ4C,YAAR,CAAqBpC,OAArB,EAA8BL,YAA9B;AACA,SAAKH,EAAL,CAAQ4C,YAAR,CAAqBpC,OAArB,EAA8BF,cAA9B;AACA,SAAKN,EAAL,CAAQ6C,WAAR,CAAoBrC,OAApB,EAJwC,CAMxC;;AACA,QAAG,KAAKR,EAAL,CAAQW,mBAAR,CAA4BH,OAA5B,EAAqC,KAAKR,EAAL,CAAQ8C,WAA7C,CAAH,EAA8D;AAC1D,aAAOtC,OAAP;AACH;;AAEDK,IAAAA,OAAO,CAACC,KAAR,CAAc,wBAAd,EAAwC,KAAKd,EAAL,CAAQe,iBAAR,CAA0BP,OAA1B,CAAxC;AACA,SAAKR,EAAL,CAAQ+C,aAAR,CAAsBvC,OAAtB;AACH;;AAEDwC,EAAAA,mBAAmB,CAACC,WAAD,EAAc;AAC7B;AACA,SAAKvB,gBAAL,GAAwBhC,OAAO,CAACiC,WAAR,CAAoBC,IAAI,CAACC,EAAL,GAAU,CAA9B,EAAiCoB,WAAjC,EAA8C,GAA9C,EAAmD,OAAnD,CAAxB,CAF6B,CAG7B;;AACA,SAAKjD,EAAL,CAAQgC,gBAAR,CAAyB,KAAKT,+BAA9B,EAA+D,KAAKvB,EAAL,CAAQiC,KAAvE,EAA8E,KAAKP,gBAAnF;AACH;;AAEDJ,EAAAA,kBAAkB,CAAC4B,WAAD,EAAc;AAC5B,WAAO,KAAKlD,EAAL,CAAQsB,kBAAR,CAA2B,KAAKd,OAAhC,EAAyC0C,WAAzC,CAAP;AACH;;AAEDC,EAAAA,eAAe,CAACC,QAAD,EAAWC,MAAX,EAAmB;AAC9B,SAAKrD,EAAL,CAAQsD,UAAR,CAAmBF,QAAnB,EAA6B,CAACC,MAAM,CAACE,CAAR,EAAWF,MAAM,CAACG,CAAlB,EAAqBH,MAAM,CAACI,CAA5B,CAA7B;AACH;;AAEDC,EAAAA,eAAe,CAACN,QAAD,EAAWO,MAAX,EAAmB;AAC9B,SAAK3D,EAAL,CAAQgC,gBAAR,CAAyBoB,QAAzB,EAAmC,KAAKpD,EAAL,CAAQiC,KAA3C,EAAkD0B,MAAlD;AACH;;AAhGQ;;AAmGb,eAAehE,MAAf","sourcesContent":["import FragmentShader from './shaders/FragmentShader';\r\nimport VertexShader from './shaders/VertexShader';\r\nimport Matrix4 from './math/Matrix4';\r\n\r\nclass Shader {\r\n    constructor(canvas, vertexShaderFile, fragmentShaderFile) {\r\n        this.canvas = canvas;\r\n        this.gl = this.canvas.getContext(\"webgl\");\r\n        this.init(vertexShaderFile, fragmentShaderFile);\r\n    }\r\n\r\n    init(vertexShaderFile, fragmentShaderFile) {\r\n        // Set up the vertex and fragment shaders (glsl)\r\n        let vertexShader = this.createShader(this.gl.VERTEX_SHADER, vertexShaderFile);\r\n        let fragmentShader = this.createShader(this.gl.FRAGMENT_SHADER, fragmentShaderFile);\r\n\r\n        // Attach shaders to our program\r\n        this.program = this.createProgram(vertexShader, fragmentShader);\r\n\r\n        // Catches additional errors /\r\n        /****(ONLY USED IN TESTING)****/\r\n        this.gl.validateProgram(this.program);\r\n        if(!this.gl.getProgramParameter(this.program, this.gl.VALIDATE_STATUS)) {\r\n            console.error(\"ERROR validating program!\", this.gl.getProgramInfoLog(this.program));\r\n        }\r\n        /****(ONLY USED IN TESTING)****/\r\n\r\n        // Tell OpenGL state machine which program should be active\r\n        this.gl.useProgram(this.program);\r\n\r\n        //Get attribute location from vertex shader text (glsl)\r\n        this.positionAttributeLocation = this.gl.getAttribLocation(this.program, \"vertPosition\");\r\n        this.normalAttributeLocation = this.gl.getAttribLocation(this.program, \"vertNormal\");\r\n        this.textureAttributeLocation = this.gl.getAttribLocation(this.program, \"vertTexCoord\");\r\n\r\n        // Get uniform location from shaders\r\n        // mat4\r\n        this.worldViewUniformLocation = this.gl.getUniformLocation(this.program, \"modelView\");\r\n        this.projectionMatrixUniformLocation = this.gl.getUniformLocation(this.program, \"perspective\");\r\n\r\n        // vec3\r\n        this.colorUniformLocation = this.gl.getUniformLocation(this.program, \"diffuseColor\");\r\n        this.timeUniformLocation = this.gl.getUniformLocation(this.program, \"time\");\r\n\r\n        // The projection matrix adds 3D perspective (depth) to the graphics\r\n        this.projectionMatrix = Matrix4.perspective(Math.PI / 5, this.canvas.width / this.canvas.height, 0.1, 10000.0);\r\n        // Link the uniform with the matrix variable\r\n        this.gl.uniformMatrix4fv(this.projectionMatrixUniformLocation, this.gl.FALSE, this.projectionMatrix);\r\n    }\r\n\r\n    use () {\r\n        this.gl.useProgram(this.program);\r\n    }\r\n\r\n    createShader(type, source) {\r\n        let shader = this.gl.createShader(type);\r\n        this.gl.shaderSource(shader, source);\r\n        this.gl.compileShader(shader);\r\n\r\n        // Check for errors\r\n        if(this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\r\n            return shader;\r\n        }\r\n\r\n        console.error(\"ERROR compiling shader!\", this.gl.getShaderInfoLog(shader));\r\n        this.gl.deleteShader(shader);\r\n    }\r\n\r\n    createProgram(vertexShader, fragmentShader) {\r\n        let program = this.gl.createProgram();\r\n        this.gl.attachShader(program, vertexShader);\r\n        this.gl.attachShader(program, fragmentShader);\r\n        this.gl.linkProgram(program);\r\n\r\n        // Check for errors\r\n        if(this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\r\n            return program;\r\n        }\r\n\r\n        console.error(\"ERROR linking program!\", this.gl.getProgramInfoLog(program));\r\n        this.gl.deleteProgram(program);\r\n    }\r\n\r\n    setProjectionMatrix(aspectRatio) {\r\n        // The projection matrix adds 3D perspective (depth) to the graphics\r\n        this.projectionMatrix = Matrix4.perspective(Math.PI / 5, aspectRatio, 0.1, 10000.0);\r\n        // Link the uniform with the matrix variable\r\n        this.gl.uniformMatrix4fv(this.projectionMatrixUniformLocation, this.gl.FALSE, this.projectionMatrix);\r\n    }\r\n\r\n    getUniformLocation(uniformName) {\r\n        return this.gl.getUniformLocation(this.program, uniformName);\r\n    }\r\n\r\n    setUniformVec3f(location, vector) {\r\n        this.gl.uniform3fv(location, [vector.x, vector.y, vector.z]);\r\n    }\r\n\r\n    setUniformMat4f(location, matrix) {\r\n        this.gl.uniformMatrix4fv(location, this.gl.FALSE, matrix);\r\n    }\r\n}\r\n\r\nexport default Shader;"]},"metadata":{},"sourceType":"module"}