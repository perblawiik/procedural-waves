{"ast":null,"code":"import Time from \"./Time\";\n\nclass Scene {\n  constructor(shaders) {\n    this.sceneObjects = [];\n    this.lightSources = [];\n    this.shaders = shaders;\n  }\n\n  addGameObject(gameObject) {\n    this.sceneObjects.push(gameObject);\n  }\n\n  addLightSource(lightSource) {\n    this.lightSources.push(lightSource);\n    let lightPositions = [];\n    let stride = 7; // 7 values per light source component, position(x,y,z) + color (r,g,b) + strength\n\n    for (let i = 0; i < this.lightSources.length; ++i) {\n      let lightSource = this.lightSources[i];\n      let positionLoc = \"lightPositions[\" + i * stride + \"]\"; //lightPositions[i * stride]     = this.lightSources[i].transform.position.x;\n      //lightPositions[i * stride + 1] = this.lightSources[i].transform.position.y;\n      //lightPositions[i * stride + 2] = this.lightSources[i].transform.position.z;\n\n      shader.setUniformVec3f(shader.getUniformLoc(positionLoc), [lightSource.transform.position.x, lightSource.transform.position.y, lightSource.transform.position.z]);\n      lightPositions[i * stride + 3] = this.lightSources[i].lightColor.x;\n      lightPositions[i * stride + 4] = this.lightSources[i].lightColor.y;\n      lightPositions[i * stride + 5] = this.lightSources[i].lightColor.z;\n      lightPositions[i * stride + 6] = this.lightSources[i].lightStrength;\n    }\n\n    let shader = this.shaders.get(\"main\");\n    shader.activate();\n    let lightPositionsUniformLoc = shader.getUniformLoc(\"lightPositions\");\n    let pointLightsUniformLoc = shader.getUniformLoc(\"pointLights\");\n    let lightColorUniformLoc = shader.getUniformLoc(\"lightColor\");\n    let lightSourceCountUniformLoc = shader.getUniformLoc(\"lightCount\"); //shader.setUniformVec3Array(lightPositionsUniformLoc, lightPositions);\n\n    shader.setUniformFloatArray(lightPositionsUniformLoc, lightPositions);\n    shader.setUniformFloatArray(pointLightsUniformLoc, lightPositions);\n    shader.setUniformVec3f(lightColorUniformLoc, this.lightSources[0].lightColor);\n    shader.setUniformInt(lightSourceCountUniformLoc, this.lightSources.length);\n  }\n\n  draw() {\n    this.sceneObjects.forEach(object => {\n      object.render(this.shaders.get(\"main\"));\n    });\n    this.lightSources.forEach(lightSource => {\n      //let currentPos = lightSource.transform.position;\n      //currentPos.x = this.lightSourceOffsetX + (100.0 * Math.sin(Time.time * 0.001));\n      //lightSource.setPosition([currentPos.x, currentPos.y, currentPos.z]);\n      lightSource.render(this.shaders.get(\"ambient\"));\n    });\n  }\n\n}\n\nexport default Scene;","map":{"version":3,"sources":["G:\\DOKUMENT\\Projekt\\React\\BlueBox\\client\\src\\js\\bluebox\\Scene.js"],"names":["Time","Scene","constructor","shaders","sceneObjects","lightSources","addGameObject","gameObject","push","addLightSource","lightSource","lightPositions","stride","i","length","positionLoc","shader","setUniformVec3f","getUniformLoc","transform","position","x","y","z","lightColor","lightStrength","get","activate","lightPositionsUniformLoc","pointLightsUniformLoc","lightColorUniformLoc","lightSourceCountUniformLoc","setUniformFloatArray","setUniformInt","draw","forEach","object","render"],"mappings":"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","sourcesContent":["import Time from \"./Time\";\r\n\r\nclass Scene {\r\n    constructor(shaders) {\r\n        this.sceneObjects = [];\r\n        this.lightSources = [];\r\n        this.shaders = shaders;\r\n    }\r\n\r\n    addGameObject(gameObject) {\r\n        this.sceneObjects.push(gameObject);\r\n    }\r\n\r\n    addLightSource(lightSource) {\r\n        this.lightSources.push(lightSource);\r\n\r\n        let lightPositions = [];\r\n        let stride = 7; // 7 values per light source component, position(x,y,z) + color (r,g,b) + strength\r\n        for (let i = 0; i < this.lightSources.length; ++i) {\r\n            let lightSource = this.lightSources[i];\r\n            let positionLoc = \"lightPositions[\" + (i * stride) + \"]\";\r\n            //lightPositions[i * stride]     = this.lightSources[i].transform.position.x;\r\n            //lightPositions[i * stride + 1] = this.lightSources[i].transform.position.y;\r\n            //lightPositions[i * stride + 2] = this.lightSources[i].transform.position.z;\r\n            shader.setUniformVec3f(shader.getUniformLoc(positionLoc), [\r\n                lightSource.transform.position.x, lightSource.transform.position.y, lightSource.transform.position.z\r\n                ]\r\n            );\r\n\r\n\r\n            lightPositions[i * stride + 3] = this.lightSources[i].lightColor.x;\r\n            lightPositions[i * stride + 4] = this.lightSources[i].lightColor.y;\r\n            lightPositions[i * stride + 5] = this.lightSources[i].lightColor.z;\r\n\r\n            lightPositions[i * stride + 6] = this.lightSources[i].lightStrength;\r\n        }\r\n\r\n        let shader = this.shaders.get(\"main\");\r\n        shader.activate();\r\n        let lightPositionsUniformLoc = shader.getUniformLoc(\"lightPositions\");\r\n        let pointLightsUniformLoc = shader.getUniformLoc(\"pointLights\");\r\n        let lightColorUniformLoc = shader.getUniformLoc(\"lightColor\");\r\n        let lightSourceCountUniformLoc = shader.getUniformLoc(\"lightCount\");\r\n\r\n        //shader.setUniformVec3Array(lightPositionsUniformLoc, lightPositions);\r\n        shader.setUniformFloatArray(lightPositionsUniformLoc, lightPositions);\r\n        shader.setUniformFloatArray(pointLightsUniformLoc, lightPositions);\r\n        shader.setUniformVec3f(lightColorUniformLoc, this.lightSources[0].lightColor);\r\n        shader.setUniformInt(lightSourceCountUniformLoc, this.lightSources.length);\r\n    }\r\n\r\n    draw() {\r\n        this.sceneObjects.forEach((object)=> {\r\n            object.render(this.shaders.get(\"main\"));\r\n        });\r\n\r\n        this.lightSources.forEach((lightSource) => {\r\n            //let currentPos = lightSource.transform.position;\r\n            //currentPos.x = this.lightSourceOffsetX + (100.0 * Math.sin(Time.time * 0.001));\r\n            //lightSource.setPosition([currentPos.x, currentPos.y, currentPos.z]);\r\n            lightSource.render(this.shaders.get(\"ambient\"));\r\n        });\r\n    }\r\n}\r\n\r\nexport default Scene;"]},"metadata":{},"sourceType":"module"}